#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#include <locale.h>
#include <time.h>
#include <ctype.h>
#include <string.h>
#include <conio.h>
#include <stddef.h>
#include <stdlib.h>

int new_zapisi(zapis, chislo_zapis);
int pechat( zapis, chislo_zapis);
int vivod_poisk( zapis, chislo_zapis);
int poisk( zapis, chislo_zapis);

struct database {
	int number;
	char tema[50];
	char FIO[50];
	int poradok;
	int min;
	int data[3];
};
typedef struct database kp;

int main() {
	setlocale(LC_ALL, "rus");
	system("chcp 1251");
	int g=1, z;
	
	int chislo_zapis = 0;
	kp zapis[100], * ptr_zapis = &zapis[chislo_zapis];
	printf("Выберите пункт\n");
	while(g != 0) {
		printf("1)Добавить новую строку\n2)Вывод записей\n3)Поиск по критериям\n0)выход\n");
		scanf("%d", &z);
		switch (z) {
		case 1:
			chislo_zapis=new_zapisi(ptr_zapis, chislo_zapis);
			break;
		case 2:
			pechat(ptr_zapis, chislo_zapis);
			break;
		case 3:
			poisk(ptr_zapis, chislo_zapis);
			break;
		case 4:
			sortirovka(ptr_zapis, chislo_zapis);
			break;
		case 5:
			/*sort(ptr_zapis,chislo_zapis);*/
				break;
		case 0:
			g = 0;
			break;
		}

	}
}
int new_zapisi(kp* zapis, int chislo_zapis) {
	for (int i = 0;i <= chislo_zapis;i++) {

		printf("Дата научного доклада\n");
		scanf("%d.%d.%d", &zapis[i].data[0], &zapis[i].data[1], &zapis[i].data[2]);

		printf("# Секции\n");
		scanf("%d", &zapis[chislo_zapis].number);
		getchar();
		printf("тема доклада\n");
		fgets(zapis[chislo_zapis].tema, 50, stdin);

		printf("Фамилия Имя Отчество\n");
		fgets(zapis[chislo_zapis].FIO, 50, stdin);

		printf("порядок\n");
		printf("%d", i +1);
		printf("\n");

		printf("Регламент в минутах\n");
		scanf("%d", &zapis[chislo_zapis].min);
		
		system("pause");
	}
	return ;
}
int pechat(kp* zapis, int chislo_zapis) {
	for (int chislo_new_zapisi =0 ;chislo_new_zapisi <= chislo_zapis;chislo_new_zapisi++) {
		printf("Дата научного доклада-%d.%d.%d\n # Секции %d\n тема доклада-%s Ф.И.О-%s Регламент в минутах-%dmin\n\n", zapis[chislo_new_zapisi].data[0], zapis[chislo_new_zapisi].data[1], zapis[chislo_new_zapisi].data[2], zapis[chislo_new_zapisi].number, zapis[chislo_new_zapisi].tema, zapis[chislo_new_zapisi].FIO, zapis[chislo_new_zapisi].min);
	}
}
int vivod_poisk(kp* zapis, int chislo_zapis) {
	printf(" # Секции %d\n тема доклада-%s Ф.И.О-%s Регламент в минутах-%dmin\n\n", zapis[chislo_zapis].number, zapis[chislo_zapis].tema, zapis[chislo_zapis].FIO, zapis[chislo_zapis].min);
}

int poisk(kp* zapis, int chislo_zapis) {
	char name_poisk[50];
	int number_poisk;
	printf("Введите Ф.И.О\n");
	getchar();
	fgets(name_poisk, 50, stdin);
	printf("Введите # секции\n");
	scanf("%d", &number_poisk);
	for (int i = 0;i <= chislo_zapis;i++) {
		if (strcmp(name_poisk, zapis[i].FIO)==0 && (number_poisk == zapis[i].number)) vivod_poisk(zapis, i);
	}
}
int compare_gpa(const void* av, const void* bv) {
	const kp* a = av, * b = bv;
	if (a->number < b->number) return -1;
	if (a->number > b->number) return 1;
	return 0;
}

int compare_name(const void* av, const void* bv) {
	const kp* a = av, * b = bv;
	return -strcmp(a->number, b->number);
}

int compare_gpaname(const void* av, const void* bv) {
	const kp* a = av, * b = bv;
	if (a->number < b->number) return -1;
	if (a->number > b->number) return 1;
	return -strcmp(a->number, b->number);
}
//int sort(kp* zapis, int chislo_zapis) {
//	qsort(zapis, 100, sizeof(kp),compare_gran);
//	for (int i = 0;i < 15;i++) {
//		printf("%d\n", zapis[i].number);
//	}
//}
int sortirovka(kp* zapis,int chislo_zapis) {
	int e = 0;
	for (int chislo_new_zapisi = 1;chislo_new_zapisi <= chislo_zapis;chislo_new_zapisi++) {
		e += zapis[chislo_new_zapisi].min;
		printf(" Регламент в минутах-%dmin\n\n", zapis[chislo_new_zapisi].min);
	}
	printf("sredthnach-%d\n", e/chislo_zapis);
}

